import{a as b}from"./chunk-FFNTSLFQ.js";import{a as Z}from"./chunk-2456SOC4.js";import{$ as j,A as f,B as c,D as p,E as M,G as F,L as $,M as A,S as w,T as D,aa as G,ba as P,c as U,ca as J,da as L,e as z,ea as X,fa as N,ga as B,h as d,i as E,ia as H,j as v,ja as Y,k as y,l as S,m as I,n as R,p as k,q as s,r as T,s as g,t as l,u as a,w as n,x as o,y as u,z as O}from"./chunk-MBWRPWEI.js";var h=class i{constructor(t,e){this.http=t;this.usersService=e;this.usersService.userSubject.subscribe(r=>{this.user=r})}reviewsSubject=new U([]);user=null;URL="https://ezaszpkcccegxlhbcgpw.supabase.co";APIkey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV6YXN6cGtjY2NlZ3hsaGJjZ3B3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU4NzI5MjEsImV4cCI6MjA3MTQ0ODkyMX0.CIVNnI1ZULLwVXUDhbyXajo8H32sPyXdriSqUcEyUNY";getReviews(){let t=new w({apikey:this.APIkey,Authorization:`Bearer ${this.APIkey}`,"Content-Type":"application/json"});return this.http.get(`${this.URL}/rest/v1/reviews?select=id,stars,description,user_id,user_profiles(email)&user_profiles!inner&order=id.desc`,{headers:t}).pipe(z(e=>e.map(r=>({id:r.id,stars:r.stars,description:r.description,email:r.user_profiles.email,user_id:r.user_id}))),d(e=>{this.reviewsSubject.next(e)}))}addReview(t,e){let r={stars:t,user_id:this.user?.user_id};e!=null&&(r.description=e);let m=new w({apikey:this.APIkey,Authorization:`Bearer ${this.user?.access_token}`,"Content-Type":"application/json"});return this.http.post(`${this.URL}/rest/v1/reviews`,r,{headers:m}).pipe(d(()=>this.getReviews().subscribe()))}deleteReview(t){let e=new w({apikey:this.APIkey,Authorization:`Bearer ${this.user?.access_token}`,"Content-Type":"application/json"});return this.http.delete(`${this.URL}/rest/v1/reviews?id=eq.${t}`,{headers:e}).pipe(d(r=>{r?this.getReviews().subscribe():alert("Feature currently disabled as this page is used for demonstration purposes!")}))}static \u0275fac=function(e){return new(e||i)(y(D),y(b))};static \u0275prov=E({token:i,factory:i.\u0275fac,providedIn:"root"})};var q=()=>[1,2,3,4,5];function Q(i,t){if(i&1){let e=O();n(0,"button",11),f("click",function(){let m=I(e).$implicit,C=c();return R(C.starClick(m))}),u(1,"img",12),o()}if(i&2){let e=t.$implicit,r=c();s(),a("src",r.starValue>=e?"https://gallery.yopriceville.com/downloadfullsize/send/23204":"https://upload.wikimedia.org/wikipedia/commons/7/7a/Star-empty.png",k)}}function K(i,t){i&1&&(n(0,"p",13),p(1,"*A star rating is required"),o())}function ee(i,t){if(i&1){let e=O();n(0,"button",17),f("click",function(){I(e);let m=c().$implicit,C=c();return R(C.deleteReview(m.id))}),u(1,"img",18),o()}}function te(i,t){if(i&1&&(n(0,"span"),u(1,"img",12),o()),i&2){let e=t.$implicit,r=c().$implicit;s(),a("src",e<=r.stars?"https://gallery.yopriceville.com/downloadfullsize/send/23204":"https://upload.wikimedia.org/wikipedia/commons/7/7a/Star-empty.png",k)}}function ie(i,t){if(i&1&&(n(0,"div",14),l(1,ee,2,0,"button",15),n(2,"p"),p(3),o(),n(4,"p"),l(5,te,2,1,"span",16),o(),n(6,"p"),p(7),o()()),i&2){let e=t.$implicit,r=c();s(),a("ngIf",e.user_id===r.user_id),s(2),M(e.email),s(2),a("ngForOf",F(4,q)),s(2),M(e.description)}}var _=class i{reviewsService=S(h);usersService=S(b);user_id=null;reviews=[];starValue=0;submitWrong=!1;starClick(t){this.starValue=t}reviewForm;ngOnInit(){this.reviewForm=new X({stars:new N(0,[P.required,P.min(1)]),description:new N("")}),this.reviewsService.getReviews().subscribe(),this.reviewsService.reviewsSubject.subscribe(t=>{this.reviews=t}),this.usersService.userSubject.subscribe(t=>{t?this.user_id=t.user_id:this.user_id=null})}onSubmit(){this.reviewForm.patchValue({stars:this.starValue}),this.reviewForm.valid?(this.submitWrong=!1,this.reviewsService.addReview(this.reviewForm.value.stars,this.reviewForm.value.description).subscribe(()=>{this.starValue=0,this.reviewForm.reset()})):this.submitWrong=!0}deleteReview(t){confirm("Do you really want to delete this review?")&&this.reviewsService.deleteReview(t).subscribe()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=T({type:i,selectors:[["app-reviws"]],standalone:!1,decls:15,vars:5,consts:[[1,"review"],[3,"ngSubmit","formGroup"],[1,"title"],["class","star-button","type","button",3,"click",4,"ngFor","ngForOf"],[1,"description"],["placeholder","Enter your review here...","formControlName","description"],["type","submit",1,"submit"],["class","error",4,"ngIf"],[1,"revs"],[1,"reviews"],["class","card",4,"ngFor","ngForOf"],["type","button",1,"star-button",3,"click"],["alt","Star Icon",1,"star",3,"src"],[1,"error"],[1,"card"],["class","delete",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"delete",3,"click"],["src","https://www.citypng.com/public/uploads/preview/rubbish-bin-basket-trash-white-icon-701751695034610kvijnfvyry.png",1,"bin"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"form",1),f("ngSubmit",function(){return r.onSubmit()}),n(2,"p",2),p(3,"Leave Your Review"),o(),l(4,Q,2,1,"button",3),n(5,"p",4),p(6,"Description:"),o(),u(7,"textarea",5),n(8,"button",6),p(9,"Submit"),o(),l(10,K,2,0,"p",7),o()(),n(11,"p",8),p(12,"-Reviews"),o(),n(13,"div",9),l(14,ie,8,5,"div",10),o()),e&2&&(s(),a("formGroup",r.reviewForm),s(3),a("ngForOf",F(4,q)),s(6),a("ngIf",r.submitWrong),s(4),a("ngForOf",r.reviews))},dependencies:[$,A,B,G,J,L,H,Y],styles:[".reviews[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));margin-top:20px;margin-bottom:20px;grid-gap:10px;border-top:1px solid rgb(104,98,98);border-bottom:1px solid rgb(104,98,98);border-radius:5px;padding:10px;max-width:100%;height:500px;overflow-y:auto}.card[_ngcontent-%COMP%]{padding:7px;position:relative;border:1px solid rgba(255,255,255,.1);border-radius:10px;background-color:#242222;box-shadow:0 2px 6px #00000080}button[_ngcontent-%COMP%]{cursor:pointer}.star-button[_ngcontent-%COMP%]{border:none;background:none;margin-bottom:10px}.star[_ngcontent-%COMP%]{width:25px;height:25px}.review[_ngcontent-%COMP%]{padding-top:50px;padding-bottom:50px;margin:10px auto 0;width:100%;max-width:500px}.review[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:0;margin-bottom:5px}.title[_ngcontent-%COMP%]{font-weight:700;margin-bottom:17px!important;font-size:30px;text-align:center;color:orange}.description[_ngcontent-%COMP%]{color:#f3e9e9}.submit[_ngcontent-%COMP%]{display:block;margin-top:10px;margin-bottom:12px;background-color:orange;color:#000;border:none;border-radius:7px;height:40px;width:130px;font-size:15px}.submit[_ngcontent-%COMP%]:hover{opacity:.9}.submit[_ngcontent-%COMP%]:active{opacity:.8}textarea[_ngcontent-%COMP%]{resize:none;width:95.7%;height:250px;outline-color:none;background-color:#2d2b2b;color:#fff;border:none;border-radius:10px;padding:10px;margin-top:3px;display:block}textarea[_ngcontent-%COMP%]:focus{outline:1px solid orange}.delete[_ngcontent-%COMP%]{position:absolute;top:8px;right:3px;cursor:pointer;border:none;background:none}.bin[_ngcontent-%COMP%]{width:15px}.error[_ngcontent-%COMP%]{color:red}.revs[_ngcontent-%COMP%]{font-weight:600;font-size:20px;margin-left:7px}"]})};var re=[{path:"",component:_}],x=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=g({type:i});static \u0275inj=v({imports:[j.forChild(re),j]})};var W=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=g({type:i});static \u0275inj=v({imports:[Z,x]})};export{W as ReviewsModule};
